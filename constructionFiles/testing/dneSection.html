<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNE Section</title>

    <script src="../scripts/custom/con_helperFunctions.js"></script>
    <script src="../scripts/custom/con_languageSwitch.js"></script>

    <link rel="stylesheet/less" type="text/css" href="../styling/construction.less">

    <!--  LESS  -->
    <script src="../scripts/libraries/less.js"></script>

    <style>
        @media only screen and (max-width: 800px) {
            div#dne-phone-container {
                min-height: 0;
                overflow: auto;
                display: block;
                white-space: nowrap;
                flex-wrap: nowrap;
            }

            a.phone-link {
                display: inline-block;
                padding: 0 10px !important;
                position: static !important;
                margin-top: 30px;
            }
        }

    </style>
</head>
<body>

<div id="content"></div>


<script>
    let currentLanguage = 'en';
    const mediaPaths = {
        "phone": "../media/device/phone/",
        "tablet": "../media/device/tablet/",
        "laptop": "../media/device/laptop/",
        "desktop": "../media/device/desktop/"
    };
    const dneSectionDetails = {
        "dne": {
            device: {
                "phone": ["welcome", "search", "restaurant", "menu", "paymentConfirmation"]
            },
            website: 'http://doc.gold.ac.uk/~dpila001/UXE/UXE_redefiningDiningExperience.html',
            tech: ["Figma"],
            structure: {
                0: {
                    domType: 'div',
                    className: 'sections row secondaryColor_light',
                    id: 'dne-container',
                    innerText: null,
                    children: {
                        0: {
                            domType: 'div',
                            className: 'desc col-sm-12',
                            id: 'dne-desc-container',
                            innerText: null,
                            children: {
                                0: {
                                    domType: 'h2',
                                    className: 'sectionTitle col-sm-6',
                                    id: 'dne-desc-title',
                                    innerText: {
                                        en: 'Dining Experience - Mobile App',
                                        fr: 'Expérience restauration - Application mobile'
                                    },
                                    children: null
                                },
                                1: {
                                    domType: 'div',
                                    className: 'row',
                                    id: null,
                                    innerText: null,
                                    children: {
                                        0: {
                                            domType: 'p',
                                            className: 'desc-text col-sm-6',
                                            id: 'dne-desc-text',
                                            innerText: {
                                                en: 'Re-imagined covid and post-pandemic dining experience through an in-depth User Experience Research strategy, resulting into an interactive prototype crafted in Figma.',
                                                fr: 'Nous avons repensé l’expérience de repas dans un context post-pandémie grâce à une stratégie de recherche approfondie sur l’expérience utilisateur (UX Research), ce qui a donné lieu à un prototype interactif conçu dans Figma.'
                                            },
                                            children: null
                                        },
                                        1: {
                                            domType: 'div',
                                            className: 'tech col-6',
                                            id: 'dne-tech',
                                            innerText: null,
                                            children: null
                                        }
                                    }
                                }
                            }
                        },
                        1: {
                            domType: 'div',
                            className: 'row',
                            id: null,
                            innerText: null,
                            children: {
                                0: {
                                    domType: 'div',
                                    className: 'device flex',
                                    id: 'dne-phone-container',
                                    innerText: null,
                                    children: null
                                }
                            }
                        }
                    }
                }
            }
        },
    }

    const popSect = () => {
        for (let sectionID in dneSectionDetails) {
            let domContainer = document.getElementById('content');
            let sectionStructure = dneSectionDetails[sectionID].structure;

            for (let firstDepthElements in sectionStructure) {
                domContainer.appendChild(customElement(sectionStructure[firstDepthElements]));
            }
        }
    }

    const popDev = () => {
        let deviceContainers = document.getElementsByClassName('device');

        Array.from(deviceContainers).forEach(container => {
            let [deviceID, deviceType] = container.id.split('-');
            if (deviceID in dneSectionDetails) {
                createImgEl(deviceID, deviceType, container);
            }
        });
    }

    const createImgEl = (deviceID, deviceType, container) => {
        dneSectionDetails[deviceID]['device'][deviceType].forEach(elData => {
            // Create Link and Image element
            let deviceLink = customElement({
                domType: 'a',
                className: deviceType + '-link',
                target: '_blank',
                href: dneSectionDetails[deviceID].website + '#' + elData
            });
            let deviceImage = customElement({
                domType: 'img',
                className: deviceType,
                id: deviceID + '-' + deviceType + '-' + elData,
                src: mediaPaths[deviceType] + deviceID + '-' + deviceType + '-' + elData + '.png',
                alt: makeAlt(deviceID, elData, deviceType)
            });

            // Append elements
            deviceLink.appendChild(deviceImage);
            container.appendChild(deviceLink);
        });
    }

    // Create Alternative Text for Images
    // Retrieve current section container,
    // look for 'sectionTitle' class within all child, get inner text and use to build alt text phrase.
    function makeAlt(deviceID, elName, deviceType) {
        let sectionContainer = document.querySelector('#' + deviceID + '-container');
        let sectionTitleNode = sectionContainer.querySelectorAll('.sectionTitle');
        let sectionTitle = sectionTitleNode[0].innerText;
        return sectionTitle + ': ' + deviceType + ' mockup - ' + elName + ' view';
    }
    const runFunc = () => {
        popSect();
        popDev();
    }
    runFunc()
</script>



<!-- Bootstrap: JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
        crossorigin="anonymous"></script>
</body>
</html>
